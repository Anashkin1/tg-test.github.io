(function(){"use strict";var e={3927:function(e,t,a){var l=a(9242),n=a(3396);const o={class:"container"};function s(e,t,a,l,s,r){const i=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)("div",o,[(0,n.Wm)(i)])}var r={name:"App",components:{}},i=a(89);const c=(0,i.Z)(r,[["render",s]]);var d=c,u=a(2483),p=a(7139);const _={class:"hello"},h=(0,n.uE)('<p data-v-b9167eee> For a guide and recipes on how to configure / customize this project,<br data-v-b9167eee> check out the <a href="https://cli.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>vue-cli documentation</a>. </p><h3 data-v-b9167eee>Installed CLI Plugins</h3><ul data-v-b9167eee><li data-v-b9167eee><a href="https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-babel" target="_blank" rel="noopener" data-v-b9167eee>babel</a></li><li data-v-b9167eee><a href="https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-eslint" target="_blank" rel="noopener" data-v-b9167eee>eslint</a></li></ul><h3 data-v-b9167eee>Essential Links</h3><ul data-v-b9167eee><li data-v-b9167eee><a href="https://vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>Core Docs</a></li><li data-v-b9167eee><a href="https://forum.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>Forum</a></li><li data-v-b9167eee><a href="https://chat.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>Community Chat</a></li><li data-v-b9167eee><a href="https://twitter.com/vuejs" target="_blank" rel="noopener" data-v-b9167eee>Twitter</a></li><li data-v-b9167eee><a href="https://news.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>News</a></li></ul><h3 data-v-b9167eee>Ecosystem</h3><ul data-v-b9167eee><li data-v-b9167eee><a href="https://router.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>vue-router</a></li><li data-v-b9167eee><a href="https://vuex.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>vuex</a></li><li data-v-b9167eee><a href="https://github.com/vuejs/vue-devtools#vue-devtools" target="_blank" rel="noopener" data-v-b9167eee>vue-devtools</a></li><li data-v-b9167eee><a href="https://vue-loader.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>vue-loader</a></li><li data-v-b9167eee><a href="https://github.com/vuejs/awesome-vue" target="_blank" rel="noopener" data-v-b9167eee>awesome-vue</a></li></ul>',7);function g(e,t,a,l,o,s){return(0,n.wg)(),(0,n.iD)("div",_,[(0,n._)("h1",null,(0,p.zw)(a.msg),1),h])}var v={name:"HelloWorld",props:{msg:String}};const f=(0,i.Z)(v,[["render",g],["__scopeId","data-v-b9167eee"]]);var m=f;const b=e=>((0,n.dD)("data-v-8ef31226"),e=e(),(0,n.Cn)(),e),y={class:"container"},w={class:"row"},k=b((()=>(0,n._)("div",{class:"col-12 pt-1"},[(0,n._)("h1",null,"Создать счет")],-1))),C={class:"col-12 pt-1"},x={class:"row pt-1"},j={class:"col-6"},U={class:"form-group"},I=b((()=>(0,n._)("label",{for:"city"},[(0,n.Uk)("Город"),(0,n._)("span",{class:"text-danger"},"*")],-1))),S=["value"],D={class:"col-6 pt-1"},T={class:"form-group"},V=b((()=>(0,n._)("label",{for:"category"},[(0,n.Uk)("Категория"),(0,n._)("span",{class:"text-danger"},"*")],-1))),B=["disabled"],O=["value"],F={class:"row pt-1"},A={class:"col-12"},E=b((()=>(0,n._)("label",{for:"company"},[(0,n.Uk)("От какого юр.лица платим"),(0,n._)("span",{class:"text-danger"},"*")],-1))),M={class:"row pt-1"},q={class:"col-12 pt-2 pb-2"},z={class:"form-check form-check-inline"},P=b((()=>(0,n._)("label",{class:"form-check-label",for:"document_pay"},"Получать платежный документ",-1))),L={class:"row"},H={class:"col-12"},W=b((()=>(0,n._)("label",{for:"exampleFormControlSelect1"},"Желаемая дата оплаты",-1))),Y={class:"row pt-2"},Z={class:"col-6 position-relative"},K=b((()=>(0,n._)("label",{for:"inn"},[(0,n.Uk)("ИНН"),(0,n._)("span",{class:"text-danger"},"*")],-1))),N=b((()=>(0,n._)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"},null,-1))),$=[N],R={class:"col-6"},G=b((()=>(0,n._)("label",{for:"exampleFormControlSelect1"},[(0,n.Uk)("Название"),(0,n._)("span",{class:"text-danger"},"*")],-1))),J={class:"col-6 pt-1"},Q=b((()=>(0,n._)("label",{for:"exampleFormControlSelect1"},[(0,n.Uk)("КПП"),(0,n._)("span",{class:"text-danger"},"*")],-1))),X={class:"col-6 pt-1"},ee=b((()=>(0,n._)("label",{for:"exampleFormControlSelect1"},"ОГРН",-1))),te={class:"row pt-1"},ae={class:"col-12"},le=b((()=>(0,n._)("label",{for:"description"},[(0,n.Uk)("За что платим"),(0,n._)("span",{class:"text-danger"},"*")],-1))),ne={class:"row pt-1"},oe={class:"col-12"},se=b((()=>(0,n._)("label",{for:"description"},[(0,n.Uk)("Сумма"),(0,n._)("span",{class:"text-danger"},"*")],-1))),re={class:"row pt-1"},ie=b((()=>(0,n._)("div",{class:"col-12"},[(0,n._)("span",null,[(0,n.Uk)("Вложения"),(0,n._)("span",{class:"text-danger"},"*")])],-1))),ce={class:"row pb-2"},de={class:"col-12 mt-2"};function ue(e,t,a,o,s,r){const i=(0,n.up)("VueMultiselect");return(0,n.wg)(),(0,n.iD)("div",y,[(0,n._)("div",w,[k,(0,n._)("div",C,[(0,n._)("div",x,[(0,n._)("div",j,[(0,n._)("div",U,[I,(0,n.wy)((0,n._)("select",{class:"form-control",id:"city",required:"","onUpdate:modelValue":t[0]||(t[0]=t=>e.city_selected=t)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.cities,(e=>((0,n.wg)(),(0,n.iD)("option",{key:e.ID,value:e.ID},(0,p.zw)(e.VALUE),9,S)))),128))],512),[[l.bM,e.city_selected]])])]),(0,n._)("div",D,[(0,n._)("div",T,[V,(0,n.wy)((0,n._)("select",{class:"form-control",id:"category",disabled:!e.city_selected,"onUpdate:modelValue":t[1]||(t[1]=t=>e.category_selected=t),required:""},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.categoriesByCity,(e=>((0,n.wg)(),(0,n.iD)("option",{key:e.id,value:e.id},(0,p.zw)(e.name),9,O)))),128))],8,B),[[l.bM,e.category_selected]])])])]),(0,n._)("div",F,[(0,n._)("div",A,[E,(0,n.Wm)(i,{modelValue:e.companySelected,"onUpdate:modelValue":t[2]||(t[2]=t=>e.companySelected=t),"close-on-select":!0,options:e.companyByCity,placeholder:"Компания",label:"name",taggable:!0},null,8,["modelValue","options"])])]),(0,n._)("div",M,[(0,n._)("div",q,[(0,n._)("div",z,[(0,n.wy)((0,n._)("input",{class:"form-check-input",type:"checkbox",id:"document_pay","onUpdate:modelValue":t[3]||(t[3]=t=>e.document_pay=t)},null,512),[[l.e8,e.document_pay]]),P])])]),(0,n._)("div",L,[(0,n._)("div",H,[W,(0,n.wy)((0,n._)("input",{class:"form-control",type:"date","onUpdate:modelValue":t[4]||(t[4]=t=>e.date_pay_selected=t)},null,512),[[l.nr,e.date_pay_selected]])])]),(0,n._)("div",Y,[(0,n._)("div",Z,[K,(0,n.wy)((0,n._)("input",{class:"form-control",id:"inn",type:"text",required:"",style:{"padding-right":"25px"},"onUpdate:modelValue":t[5]||(t[5]=t=>e.inn_selected=t)},null,512),[[l.nr,e.inn_selected]]),((0,n.wg)(),(0,n.iD)("svg",{onClick:t[6]||(t[6]=(...e)=>r.searchCompany&&r.searchCompany(...e)),xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-search position-absolute",viewBox:"0 0 16 16"},$))]),(0,n._)("div",R,[G,(0,n.wy)((0,n._)("input",{class:"form-control",type:"text",required:"","onUpdate:modelValue":t[7]||(t[7]=t=>e.name_selected=t)},null,512),[[l.nr,e.name_selected]])]),(0,n._)("div",J,[Q,(0,n.wy)((0,n._)("input",{class:"form-control","onUpdate:modelValue":t[8]||(t[8]=t=>e.kpp_selected=t),type:"text"},null,512),[[l.nr,e.kpp_selected]])]),(0,n._)("div",X,[ee,(0,n.wy)((0,n._)("input",{class:"form-control","onUpdate:modelValue":t[9]||(t[9]=t=>e.ogrn_selected=t),type:"text"},null,512),[[l.nr,e.ogrn_selected]])])]),(0,n._)("div",te,[(0,n._)("div",ae,[le,(0,n.wy)((0,n._)("textarea",{class:"form-control",id:"description","onUpdate:modelValue":t[10]||(t[10]=t=>e.description_selected=t),rows:"3",required:""},null,512),[[l.nr,e.description_selected]])])]),(0,n._)("div",ne,[(0,n._)("div",oe,[se,(0,n.wy)((0,n._)("input",{class:"form-control",type:"number",min:"1","onUpdate:modelValue":t[11]||(t[11]=t=>e.sum_selected=t),required:""},null,512),[[l.nr,e.sum_selected]])])]),(0,n._)("div",re,[ie,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.fileInputCount,(e=>((0,n.wg)(),(0,n.iD)("div",{key:"file"+e,class:"col-12 pb-1"},[(0,n._)("input",{type:"file",onChange:t[12]||(t[12]=e=>r.uploadFile(e)),class:"form-control-file",name:"file"},null,32)])))),128))])])]),(0,n._)("div",ce,[(0,n._)("div",de,[(0,n._)("button",{type:"button",class:"add-btn btn btn-success col-12",onClick:t[13]||(t[13]=(...e)=>r.createBill&&r.createBill(...e))}," Создать заявку ")])])])}a(7658);var pe=a(6368),_e=a(6265),he=a.n(_e),ge=()=>he().create({baseURL:"https://portal-dev2.dalimo.ru/rest/128186/1duurmd2z13rojfv/",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"}}),ve={getLib(){return ge().get("bill.get.lib")},getCompany(e){return ge().get("bill.get.company",{params:{CITY:e}})},getCounterpartyByInn(e){return ge().get("bill.get.сounterparty",{params:{INN:e}})},createBill(e){return ge().post("bill.telegram.add",e,{headers:{"Content-Type":"multipart/form-data"}})}},fe={getTg(){return window.Telegram.WebApp},getUserData(){return this.getTg().initData}},me={name:"BillAdd",components:{VueMultiselect:pe.ZP},data:function(){return{chatId:this.$router.id,document_pay:null,date_pay_selected:null,city_selected:null,cities:[],category_option_selected:null,category_selected:null,categories:[],companySelected:null,companyByCity:[],categoriesByCity:[],inn_selected:null,name_selected:null,ogrn_selected:null,kpp_selected:null,description_selected:null,fileInputCount:1,file_selected:[],sum_selected:null}},methods:{uploadFile:function(e){e.target.files.length&&this.fileInputCount++},searchCompany:function(){let e="https://suggestions.dadata.ru/suggestions/api/4_1/rs/findById/party",t={query:this.inn_selected,count:10},a={headers:{Authorization:"Token dff52c00cccf530d5b66bfbf4102af9e9e6d2575"}};he().post(e,t,a).then((e=>{if(e.data&&e.data.suggestions.length){const t=e.data.suggestions.pop();t&&(this.name_selected=t.value,this.kpp_selected=t.data.kpp,this.ogrn_selected=t.data.ogrn)}})).catch((e=>{console.log(e)}))},validation:function(){let e=!0;return this.city_selected||(e=!1),this.category_selected||(e=!1),this.inn_selected||(e=!1),this.name_selected||(e=!1),this.description_selected||(e=!1),this.companySelected||(e=!1),this.sum_selected||(e=!1),this.file_selected=this.getFiles(),0===this.file_selected.length&&(e=!1),e},getFiles:function(){const e=[];return document.querySelectorAll('[name="file"]').forEach((t=>{t.files.length&&e.push(t.files[0])})),e},createBill:function(){this.validation()?ve.createBill({chat_id:this.chatId,title:this.description_selected,city:this.city_selected,category:this.category_selected,company:this.companySelected,data_pay:this.date_pay_selected,document_pay:this.document_pay,sum:this.sum_selected,counterparty:{inn:this.inn_selected,name:this.name_selected,kpp:this.kpp_selected,ogrn:this.ogrn_selected},files:this.getFiles()}).then((e=>{if(e.data.result){let t=e.data.result;fe.getTg().sendData(`Счет №${t} успешно создан.`)}})).catch((e=>{alert(e.message)})):fe.getTg().showAlert("Необходимо заполнить все обязательные поля")}},watch:{city_selected:function(e){this.companySelected=null,this.category_option_selected=null;const t=[...this.categories].filter((t=>t.city===e));this.categoriesByCity=t,ve.getCompany(e).then((e=>{e.data&&(this.companyByCity=e.data.result)}))}},created(){this.chatId=this.$route.params.id,fe.getTg().expand(),console.log(fe.getUserData()),ve.getLib().then((e=>{e.data&&(this.cities=e.data.result.CITIES,this.categories=e.data.result.CATEGORIES)}))}};const be=(0,i.Z)(me,[["render",ue],["__scopeId","data-v-8ef31226"]]);var ye=be,we=(0,u.p7)({history:(0,u.PO)(),routes:[{path:"/",component:m},{path:"/bill/add/:id",component:ye}]});a(2166);const ke=(0,l.ri)(d);ke.use(we),ke.mount("#app")}},t={};function a(l){var n=t[l];if(void 0!==n)return n.exports;var o=t[l]={exports:{}};return e[l](o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,l,n,o){if(!l){var s=1/0;for(d=0;d<e.length;d++){l=e[d][0],n=e[d][1],o=e[d][2];for(var r=!0,i=0;i<l.length;i++)(!1&o||s>=o)&&Object.keys(a.O).every((function(e){return a.O[e](l[i])}))?l.splice(i--,1):(r=!1,o<s&&(s=o));if(r){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[l,n,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,l){var n,o,s=l[0],r=l[1],i=l[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(n in r)a.o(r,n)&&(a.m[n]=r[n]);if(i)var d=i(a)}for(t&&t(l);c<s.length;c++)o=s[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},l=self["webpackChunkdalimo24_web_app"]=self["webpackChunkdalimo24_web_app"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[998],(function(){return a(3927)}));l=a.O(l)})();
//# sourceMappingURL=app.14a794d8.js.map